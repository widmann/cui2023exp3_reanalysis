library(lmerTest)
library(MuMIn)
library(psych)
library(ggplot2)
library(emmeans)
library(sjPlot)
library(dplyr)
library(tidyr)
options(scipen = 4, width = 100)
rm(list = ls())
theme_set(theme_gray(base_size = 10))
okabe <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Import data
dat <- read.csv(file = "eyedata.csv")
dat$subj = factor(dat$subj)
dat$cond = factor(dat$cond, labels = c("Intact", "Scrambled"))
dat$block = factor(dat$block)
# dat$snr_ctr = scale(dat$snr, scale = F, center = T)
dat$snr_ctr = dat$snr - 3
# dat$trial_ctr = scale(dat$trial, scale = F, center = T)
dat$trial_ctr = dat$trial - 11.5
describeBy(pa ~ trial + cond, data = dat, digits = 1, mat = T)
dat_cond_trial <- dat %>%
group_by(cond, trial) %>%
summarise(pa_sd = sd(pa), pa_mean = mean(pa))
n <- nlevels(dat$subj)
ggplot(dat_cond_trial, aes(x = trial, y = pa_mean, col = cond)) +
geom_ribbon(aes(min = pa_mean - pa_sd / sqrt(n) * 1.96, max = pa_mean + pa_sd / sqrt(n) * 1.96, fill = cond), color = NA, alpha = 0.15) +
geom_line() +
geom_point() +
scale_color_manual(values = okabe[c(6,8)]) +
scale_fill_manual(values = okabe[c(6,8)]) +
labs(color = "Condition", fill = "Condition") +
labs(x = "Trial #", y = "Pupil area [a.u.]") +
theme(legend.position = "bottom")
